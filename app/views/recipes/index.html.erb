<h1>Recettes</h1>

<% @recipes_by_category.each do |category, recipes| %>
  <% unless recipes.empty? %>
    <h2><%= category %></h2>
    <table class="table table-condensed">
      <tr>
        <th>Nom</th>
        <th>Recette pour</th>
        <th>Coût</th>
      </tr>
      <% recipes.each do |recipe| %>
        <tr>
          <td><%= link_to recipe.name, recipe %></td>
          <td><%= "#{recipe.quantity} #{recipe.unit}" %></td>
          <td>
            <% if recipe.unit == "personnes" or recipe.unit == "parts" %>
              <%= (recipe.cost / recipe.quantity).round(2) %>€ par <%= recipe.unit %>
            <% else %>
              <%= recipe.cost.round(2) %>€
            <% end %>
          </td>
        </tr>
      <% end %>
    </table>
  <% end %>
<% end %>

<br />
<hr />

<%= form_for(Recipe.new) do |f| %>
  <%= f.text_field :name, size: 40 %> pour <%= f.number_field :quantity, size: 4 %> <%= f.collection_select :unit, Recipe::UNITS, :to_s, :to_s %> <%= f.collection_select :recipe_category_id, RecipeCategory.all, :id, :name %> <%= f.submit "Créer cette recette" %>
<% end %>
<br />
<%= form_for(RecipeCategory.new) do |f| %>
  <%= f.text_field :name, size: 20 %>
  <%= f.submit "Ajouter catégorie" %>
<% end %>
